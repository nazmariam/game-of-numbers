(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(2),l=a.n(n),i=(a(14),a(3)),o=a(4),c=a(6),h=a(5),v=a(7),m=function(e){for(var t=[],a=0;a<4;a++){for(var s=[],r=0;r<4;r++)s.push(e[3-r][a]);t.push(s)}return t},u=function(e,t,a,s,r){return e[t]&&e[t][a]&&e[t][a]===e[s][r]},f=function(e){var t=e.props.gameOver,a=!1,s=JSON.parse(localStorage.getItem("score"));return function(){var n=e.props.cells,l=e.props.latestCoordinates,i=e.props.score,o=n.map(function(e,t){return e.map(function(e,s){return 2048===e&&(a=!0),r.a.createElement("div",{className:"cell-wrapper",key:"wrap-"+t+s+e},r.a.createElement("div",{className:"cell "+(l&&t===l.i&&s===l.j?" new":"")+" cell_"+e},e||""," "))})});return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h1",{className:"welcome"},"Welcome on board!"),r.a.createElement("h3",{className:"score"},"Your score: ",i||0),r.a.createElement("h3",{className:"best-score score"},"Best score: ",s||0," ")),r.a.createElement("div",{className:"field"},o," ",a?r.a.createElement("div",{className:"loose"},r.a.createElement("h1",null,"You win!")):""," ",t?r.a.createElement("div",{className:"loose"},r.a.createElement("h1",null,"You loose")):""))}()},d=function(e){function t(){var e,a;Object(i.a)(this,t);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(a=Object(c.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={cells:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],latestCoordinates:{},gameOver:!1,score:0},a.size=4,a.checkStep=function(e,t){var s=[];return e.forEach(function(e){for(var t=[],r=0;r<4;r++)0!==e[r]&&t.push(e[r]);for(;t.length<4;)t.push(0);for(var n=0;n<t.length-1;n++)if(0===t[n])t[n]=t[n+1],t[n+1]=0;else if(t[n]===t[n+1]){t[n]=t[n]+t[n+1];var l=a.state.score+t[n+1];a.setState({score:l}),t[n+1]=0}s.push(t)}),t=JSON.stringify(e)!==JSON.stringify(s),{arr:e=s,moved:t}},a.restart=function(){var e=a.makeRandomCell(a.makeRandomCell([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]));a.setState({cells:e,latestCoordinates:{},gameOver:!1,score:0})},a}return Object(v.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.state.cells,t=this.makeRandomCell(e);this.setState(this.makeRandomCell(t));var a,s,r,n,l,i,o=document.querySelector(".field");document.addEventListener("keydown",this.handleKeyDown.bind(this)),o.addEventListener("touchstart",function(e){e.preventDefault();var t=e.changedTouches[0];a="none",s=t.pageX,r=t.pageY,i=(new Date).getTime()},!1),o.addEventListener("touchend",function(e){e.preventDefault();var t=e.changedTouches[0];if(n=t.pageX-s,l=t.pageY-r,(new Date).getTime()-i&&(Math.abs(n)>=150&&Math.abs(l)<=100?a=n<0?"left":"right":Math.abs(l)>=150&&Math.abs(n)<=100&&(a=l<0?"up":"down")),"up"===a){var o=this.moveUp(this.state.cells);this.setState(o)}else if("right"===a){var c=this.moveRight(this.state.cells);this.setState({cells:c})}else if("down"===a){var h=this.moveDown(this.state.cells);this.setState({cells:h})}else if("left"===a){var v=this.moveLeft(this.state.cells);this.setState({cells:v})}}.bind(this),!1)}},{key:"setBestScore",value:function(){var e=this.state.score;e>JSON.parse(localStorage.getItem("score"))&&function(e,t){var a=(localStorage[t]?JSON.parse(localStorage[t]):[]).slice();e&&(-1===a.indexOf(e)&&a.splice(0,1,e),localStorage[t]=JSON.stringify(a))}(e,"score")}},{key:"ifGamesOver",value:function(e){this.isGameOver(e)&&(this.setBestScore(),this.setState({gameOver:!0}))}},{key:"makeRandomCell",value:function(e){var t=e.slice(),a=this.availableCells(t);if(this.availableCells(t).length){var s=Math.floor(Math.random()*a.length);t[a[s].i][a[s].j]=Math.random()<.9?2:4,this.setState({latestCoordinates:{i:a[s].i,j:a[s].j}})}return t}},{key:"availableCells",value:function(e){var t=[],a=e;if(a.length)for(var s=0;s<this.size;s++)for(var r=0;r<this.size;r++)0===a[s][r]&&t.push({i:s,j:r});return t}},{key:"areMatches",value:function(e){for(var t=e.slice(),a=0;a<this.size;a++)for(var s=0;s<this.size;s++)return u(t,a-1,s,a,s)||u(t,a,s-1,a,s)||u(t,a,s+1,a,s)||u(t,a+1,s,a,s)}},{key:"isGameOver",value:function(e){return!this.areMatches(this.state.cells)&&!this.availableCells(e).length}},{key:"handleKeyDown",value:function(e){var t=this.state.cells;if(38===e.keyCode){var a=this.moveUp(t);this.setState({cells:a})}else if(39===e.keyCode){var s=this.moveRight(t);this.setState({cells:s})}else if(40===e.keyCode){var r=this.moveDown(t);this.setState({cells:r})}else if(37===e.keyCode){var n=this.moveLeft(t);this.setState({cells:n})}}},{key:"moveUp",value:function(e){var t=m(m(m(e.slice()))),a=!1,s=this.checkStep(t,a);return t=m(s.arr),a=s.moved,this.ifGamesOver(t),a?this.makeRandomCell(t):t}},{key:"moveDown",value:function(e){var t=m(e.slice()),a=!1,s=this.checkStep(t,a);return t=m(m(m(s.arr))),a=s.moved,this.ifGamesOver(t),a?this.makeRandomCell(t):t}},{key:"moveLeft",value:function(e){var t=e.slice(),a=!1,s=this.checkStep(t,a);return t=s.arr,a=s.moved,this.ifGamesOver(t),a?this.makeRandomCell(t):t}},{key:"moveRight",value:function(e){var t=m(m(e.slice())),a=!1,s=this.checkStep(t,a);return t=m(m(s.arr)),a=s.moved,this.ifGamesOver(t),a?this.makeRandomCell(t):t}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f,{props:this.state}),r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{onClick:this.restart},"New Game")))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(d,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},8:function(e,t,a){e.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.7ff8d5d6.chunk.js.map