(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),i=a(2),n=a.n(i),o=(a(14),a(3)),l=a(4),c=a(6),h=a(5),v=a(7),m=function(e){for(var t=[],a=0;a<4;a++){for(var s=[],r=0;r<4;r++)s.push(e[3-r][a]);t.push(s)}return t},u=function(e,t,a,s,r){return e[t]&&e[t][a]&&e[t][a]===e[s][r]},f=function(e){var t=e.props.gameOver,a=!1,s=JSON.parse(localStorage.getItem("score"));return function(){var i=e.props.cells,n=e.props.latestCoordinates,o=e.props.score,l=i.map(function(e,t){return e.map(function(e,s){return 2048===e&&(a=!0),r.a.createElement("div",{className:"cell-wrapper",key:"wrap-"+t+s+e},r.a.createElement("div",{className:"cell "+(n&&t===n.i&&s===n.j?" new":"")+" cell_"+e},e||""," "))})});return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h1",{className:"welcome"},"Welcome on board!"),r.a.createElement("h3",{className:"score"},"Your score: ",o||0),r.a.createElement("h3",{className:"best-score score"},"Best score: ",s||0," ")),r.a.createElement("div",{className:"field"},l," ",a?r.a.createElement("div",{className:"loose"},r.a.createElement("h1",null,"You win!")):""," ",t?r.a.createElement("div",{className:"loose"},r.a.createElement("h1",null,"You loose")):""))}()},d=function(e){function t(){var e,a;Object(o.a)(this,t);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={cells:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],latestCoordinates:{},gameOver:!1,score:0},a.size=4,a.checkStep=function(e,t,s,r){if(0!==e[t][s]&&0===e[t-1][s])e[t-1][s]=e[t][s],e[t][s]=0,r=!0,t>=2&&(a.checkStep(e,t-1,s,r),r=!0,3===t&&(a.checkStep(e,t-2,s,r),r=!0));else if(e[t][s]===e[t-1][s]){e[t-1][s]=e[t][s]+e[t-1][s];var i=a.state.score+e[t][s];a.setState({score:i}),e[t][s]=0,r=!0}return{arr:e,moved:r}},a.restart=function(){var e=a.makeRandomCell(a.makeRandomCell([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]));a.setState({cells:e,latestCoordinates:{},gameOver:!1,score:0})},a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.state.cells,t=this.makeRandomCell(e);this.setState(this.makeRandomCell(t));var a,s,r,i,n,o,l=document.querySelector(".field");document.addEventListener("keydown",this.handleKeyDown.bind(this)),l.addEventListener("touchstart",function(e){e.preventDefault();var t=e.changedTouches[0];a="none",s=t.pageX,r=t.pageY,o=(new Date).getTime()},!1),l.addEventListener("touchend",function(e){e.preventDefault();var t=e.changedTouches[0];if(i=t.pageX-s,n=t.pageY-r,(new Date).getTime()-o&&(Math.abs(i)>=150&&Math.abs(n)<=100?a=i<0?"left":"right":Math.abs(n)>=150&&Math.abs(i)<=100&&(a=n<0?"up":"down")),"up"===a){var l=this.moveUp(this.state.cells);this.setState(l)}else if("right"===a){var c=this.moveRight(this.state.cells);this.setState({cells:c})}else if("down"===a){var h=this.moveDown(this.state.cells);this.setState({cells:h})}else if("left"===a){var v=this.moveLeft(this.state.cells);this.setState({cells:v})}}.bind(this),!1)}},{key:"setBestScore",value:function(){var e=this.state.score;e>JSON.parse(localStorage.getItem("score"))&&function(e,t){var a=(localStorage[t]?JSON.parse(localStorage[t]):[]).slice();e&&(-1===a.indexOf(e)&&a.push(e),100===a.length&&a.shift(),localStorage[t]=JSON.stringify(a))}(e,"score")}},{key:"ifGamesOver",value:function(e){this.isGameOver(e)&&(this.setBestScore(),this.setState({gameOver:!0}))}},{key:"makeRandomCell",value:function(e){var t=e.slice(),a=this.availableCells(t);if(this.availableCells(t).length){var s=Math.floor(Math.random()*a.length);t[a[s].i][a[s].j]=Math.random()<.9?2:4,this.setState({latestCoordinates:{i:a[s].i,j:a[s].j}})}return t}},{key:"availableCells",value:function(e){var t=[],a=e;if(a.length)for(var s=0;s<this.size;s++)for(var r=0;r<this.size;r++)0===a[s][r]&&t.push({i:s,j:r});return t}},{key:"areMatches",value:function(e){for(var t=e.slice(),a=0;a<this.size;a++)for(var s=0;s<this.size;s++)return u(t,a-1,s,a,s)||u(t,a,s-1,a,s)||u(t,a,s+1,a,s)||u(t,a+1,s,a,s)}},{key:"isGameOver",value:function(e){return!this.areMatches(this.state.cells)&&!this.availableCells(e).length}},{key:"handleKeyDown",value:function(e){var t=this.state.cells;if(38===e.keyCode){var a=this.moveUp(t);this.setState(a)}else if(39===e.keyCode){var s=this.moveRight(t);this.setState({cells:s})}else if(40===e.keyCode){var r=this.moveDown(t);this.setState({cells:r})}else if(37===e.keyCode){var i=this.moveLeft(t);this.setState({cells:i})}}},{key:"moveUp",value:function(e){for(var t,a=e.slice(),s=!1,r=0;r<this.size;r++)for(var i=1;i<this.size;i++)t=this.checkStep(a,i,r,s);return a=t.arr,s=t.moved,this.ifGamesOver(a),s?this.makeRandomCell(a):a}},{key:"moveDown",value:function(e){for(var t,a=e.slice(),s=m(m(a)),r=!1,i=0;i<this.size;i++)for(var n=1;n<this.size;n++)t=this.checkStep(s,n,i,r);return a=m(m(t.arr)),r=t.moved,this.ifGamesOver(a),r?this.makeRandomCell(a):a}},{key:"moveLeft",value:function(e){for(var t,a=e.slice(),s=m(a),r=!1,i=0;i<this.size;i++)for(var n=1;n<this.size;n++)t=this.checkStep(s,n,i,r);return a=m(m(m(t.arr))),r=t.moved,this.ifGamesOver(a),r?this.makeRandomCell(a):a}},{key:"moveRight",value:function(e){for(var t,a=e.slice(),s=m(m(m(a))),r=!1,i=0;i<this.size;i++)for(var n=1;n<this.size;n++)t=this.checkStep(s,n,i,r);return a=m(t.arr),r=t.moved,this.ifGamesOver(a),r?this.makeRandomCell(a):a}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f,{props:this.state}),r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{onClick:this.restart},"New Game")))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(r.a.createElement(d,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},8:function(e,t,a){e.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.ed1f0dd3.chunk.js.map